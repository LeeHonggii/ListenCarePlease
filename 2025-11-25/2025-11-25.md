# 파이프라인 변경
## 변경 전 파이프라인
┌─────────────────────────────────────────────────────────────┐
│                    PROJECT PIPELINE WORKFLOW                │
└─────────────────────────────────────────────────────────────┘
                               │
                               ▼
┌─────────────────────── [ 1. INPUT ] ────────────────────────┐
│                                                             │
│   📄  회의 전사록 (.txt)                                    │
│       - 이름/타임스탬프 전처리 완료된 텍스트 데이터           │
│                                                             │
└──────────────────────────────┬──────────────────────────────┘
                               │
                               ▼
┌────────────────── [ 2. EXTRACTION (LLM) ] ──────────────────┐
│                                                             │
│   🤖  문맥 파악 및 후보 추출 (Map)                          │
│       - 긴 텍스트 Chunking (조각내기)                        │
│       - 비전공자가 모를 법한 전문/기술/은어 추출              │
│       - (Output: 방대한 후보 단어 리스트)                    │
│                                                             │
└──────────────────────────────┬──────────────────────────────┘
                               │
                               ▼
┌─────────────────── [ 3. SELECTION (LLM) ] ──────────────────┐
│                                                             │
│   ⚖️  핵심 단어 선별 (Reduce)                               │
│       - 전체 후보군 중 중요도/난이도 평가                    │
│       - 중복 제거 및 표준어 표기 통일                        │
│       - (Output: 정제된 Top 20 단어 리스트)                  │
│                                                             │
└──────────────────────────────┬──────────────────────────────┘
                               │
                               ▼
┌──────────────────── [ 4. DICTIONARY ] ──────────────────────┐
│                                                             │
│   📚  외부 데이터 로드 (Retrieval)                          │
│       - 선별된 20개 단어에 대한 사전적 정의 검색             │
│       - Wikipedia, 표준국어대사전, 사내 용어집 등 활용       │
│       - (Output: 단어 + 사전적 정의 텍스트)                  │
│                                                             │
└──────────────────────────────┬──────────────────────────────┘
                               │
                               ▼
┌────────────────── [ 5. GENERATION (LLM) ] ──────────────────┐
│                                                             │
│   ✍️  최종 뜻풀이 생성 (Synthesis)                          │
│       - [문맥 정보] + [사전 정보] 결합                       │
│       - 회의 상황에 맞는 쉬운 해설로 재작성                  │
│       - (Output: 단어: 맞춤형 해설 쌍)                       │
│                                                             │
└──────────────────────────────┬──────────────────────────────┘
                               │
                               ▼
┌─────────────────────── [ 6. OUTPUT ] ───────────────────────┐
│                                                             │
│   💾  최종 결과 저장 (.json)                                │
│       - [{"word": "LLM", "desc": "설명..."}, ...]           │
│                                                             │
└─────────────────────────────────────────────────────────────┘

## 변경 후 파이프라인
┌─────────────────────────────────────────────────────────────┐
│                 FINAL PROJECT PIPELINE                      │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────── [ 1. INPUT ] ────────────────────────┐
│                                                             │
│   📄  회의록 원본 파일 (.txt)                                │
│       - 예: "홍기: 이번에 LLM 도입을..."                     │
│       - (발화자 이름과 대화 내용이 모두 포함된 상태)           │
│                                                             │
└─────────────────────────────┬───────────────────────────────┘
                              │
          ┌───────────────────┴───────────────────┐
          │      🐍 Python Pre-processing         │
          │         (데이터를 두 개로 분리)         │
          └───────────────────┬───────────────────┘
                              │
            ┌─────────────────┴─────────────────┐
            ▼                                   ▼
┌──────────────────────────┐      ┌───────────────────────────┐
│ (Path A) 분석용 텍스트     │      │ (Path B) 원본 보존 리스트   │
│                          │      │                           │
│ "이번에 LLM 도입을..."     │      │ ["홍기: 이번에 LLM...",   │
│ (이름 제거, 텍스트만 추출)  │      │  "민서: 네 알겠습니다."]   │
└───────────┬──────────────┘      └─────────────┬─────────────┘
            │                                   │
            ▼                                   │
┌──────────────────────────┐                    │
│ [ 2. LLM ANALYSIS ]      │                    │
│                          │                    │
│ 🤖 DeepSeek / GPT / Solar│                    │
│    - "전문용어 20개 추출해" │                    │
│    - "뜻풀이 작성해"       │                    │
│                          │                    │
│ Output: JSON 리스트      │                    │
│ [{"word":"LLM", ...}]    │                    │
└───────────┬──────────────┘                    │
            │                                   │
            │ (용어 리스트 & 뜻)                  │
            ▼                                   │
┌───────────────────────────────────────────────┴─────────────┐
│ [ 3. PYTHON ANNOTATION (Post-processing) ]                  │
│                                                             │
│ 🐍 파이썬 코드 작동                                          │
│    1. (Path B)의 원본 리스트를 한 줄씩 읽음                  │
│    2. LLM이 찾은 단어("LLM")가 있는지 확인                   │
│    3. 있으면 "(1)LLM" 형태로 텍스트 치환 (Replace)           │
│                                                             │
└─────────────────────────────┬───────────────────────────────┘
                              │
                              ▼
┌────────────────────── [ 4. OUTPUT ] ────────────────────────┐
│                                                             │
│   💾  최종 결과 파일 (.txt)                                  │
│                                                             │
│   [Section 1: 본문]                                         │
│   "홍기: 이번에 (1)LLM 도입을..."                            │
│                                                             │
│   -------------------------------------------------------   │
│                                                             │
│   [Section 2: 해설]                                         │
│   (1) LLM : 거대 언어 모델. 인간처럼 텍스트를 생성하는 AI...   │
│                                                             │
└─────────────────────────────────────────────────────────────┘

## 변경 이유
- 현재 진행중인 Task의 결과와 가치에 대해 LLM을 3번 호출하는 것은 과도하다고 생각
- 추출하는 것은 전문용어/은어/약어/신조어 등
    - 사전에는 등재되지 않은 단어 다수
    - 사전 사용 비율보다 LLM 생성 비율이 압도적으로 높다고 판단
- 비용적/시간적 측면에서 LLM 1회 호출이 우세

# 시도 방식
## 기존 방식
### 단어 중요도 추출
- 추출된 단어의 개수가 과도하다고 판단(50개 ~ 90개)
- LLM을 사용하여 추출 된 단어 중 20개 이하로 재추출
- Solar Test
    - 중요도가 높지 않거나, 오타 등의 단어도 모두 추출
    - 의미가 중복되는 단어도 모두 추출하는 상황

## 변경 방식 (All in One LLM)
- DeepSeek V3
    - 기본 단어 추출과 뜻 매치의 경우 준수한 성능
    - 오타 등의 문자도 주요 단어로 추출
    - 동일한 의미를 가진 단어들(클러스터링/군집화, 애니알/ER)에 대해 개별 출력 - 합성을 명령했지만 실패
    - 단어 개수 제한 정상 작동
    - 중요도가 낮아보이는 단어(화자 등)도 존재

- Claude 3.5 Haiku
    - 단어 추출과 뜻 매치의 부분에서 준수한 성능
    - 임베딩/인베딩, 클러스터링/군집화 등의 오타 혹은 겹치는 의미의 단어들에 대한 중복 제거 실패(3회 시도)
    - 단어 개수 제한 정상 작동(15개 ~ 17개 추출)

- Solar mini
    - 전체적으로 매우 나쁜 성능
    - 같은 단어 구분 실패
    - 중복 출력(NNT, NNT, NNT, NNT, NNT, …)
    - 폐기

- GPT-5-mini
    - 4가지 모델 중 가장 준수한 성능으로 보임
    - 겹치는 단어나 오타에 대한 병합 과정이 정상적으로 이루어짐
    - 단어 개수 제한 정상 작동(20개)
    - 단어 옆에 ()로 해석(번역)등이 들어감

# 생각
- LLM 단어 선별 → 사전 load → LLM으로 뜻 요약 및 생성
- 위 과정이면 사전 load가 없으면 한번에 가능
- 사전 load과정이 중요한가? 판단 필요
    - 사전 유무에 대한 결과를 비용과 정확도 면에서 확인해봐야 하나?
    - LLM을 3회 호출하는 과정이 너무 무겁다고 판단
    - 전문용어/약어/신조어의 경우 사전에 없는 경우가 다수
    - 사전 부분을 제외하고, LLM 1회 호출로 변경
        - All in One으로 진행
        - 한번의 호출에 prompt로 과정 병합 및 시행
- 회의록 전사 파일이 100% 정확하지 않아 이상한 단어들이 추출
    - 단어 개수 제한을 둬야하나?
        - 둔다면 몇개로?
        - 20개 이하
    - 회의록이 아닌 제대로 되어있는 수기록을 사용해야하나?
        - 어떤 데이터들이 존재하나?

# 원문 전사록과 병합
- 태깅 텍스트 + 주석 처리 정상 진행
- 각 주석에 index 처리 정상
- 원문에 index 처리 문제
- 오타 수정 후 주석 처리 작동
    - 수정 된 오타에 대한 원문 index처리 실패

# 진행 예정
- index 처리
- prompt 강화